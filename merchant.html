 <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dashboard Marchand</title>
</head>
<body>

<h2 id="welcome"></h2>
<div id="status"></div>
<div id="dashboard" style="display:none;">
  <h3>Dashboard Marchand</h3>
  <p>Vous pouvez maintenant ajouter des produits.</p>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import { 
  getAuth, 
  onAuthStateChanged 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import { 
  getFirestore, 
  doc,
  getDoc 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB3rKXZjJqskewJM-cBvBRw8-ecJPvoeBw",
  authDomain: "angcomerce-v1.firebaseapp.com",
  projectId: "angcomerce-v1",
  storageBucket: "angcomerce-v1.firebasestorage.app",
  messagingSenderId: "238735890157",
  appId: "1:238735890157:web:db3f87960db7916d7fdee4"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const welcome = document.getElementById("welcome");
const statusDiv = document.getElementById("status");
const dashboard = document.getElementById("dashboard");

onAuthStateChanged(auth, async (user) => {

  if (!user) {
    window.location.href = "index.html";
    return;
  }

  welcome.innerText = "Bienvenue " + user.email;

  const merchantDoc = await getDoc(doc(db, "merchants", user.uid));

  if (!merchantDoc.exists()) {
    statusDiv.innerHTML = "<p>Erreur compte introuvable.</p>";
    return;
  }

  const data = merchantDoc.data();

  // ðŸ”’ VÃ©rification validation
  if (data.verified !== true) {

    statusDiv.innerHTML = `
      <h3 style="color:red;">
        Votre compte est en attente de validation.
      </h3>
      <p>Contactez lâ€™administrateur.</p>
    `;

    dashboard.style.display = "none";

  } else {

    statusDiv.innerHTML = `
      <h3 style="color:green;">
        Compte validÃ© âœ…
      </h3>
      <p>Badge : ${data.badge}</p>
    `;

    dashboard.style.display = "block";
  }

});

</script>

</body>
</html>
